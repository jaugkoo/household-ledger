# 영수증 자동화 - 사용 가이드

## 🚀 빠른 시작 (신규 사용자)

### 1단계: 설치 및 자동 시작 설정

1. **install.bat** 파일을 **더블클릭**하세요
2. 설정 창이 나타나면 다음 정보를 입력:
   - OpenAI API Key
   - Notion Integration Token
   - Notion Database ID
   - 모니터링할 폴더 (기본: OneDrive 카메라 앨범)
3. "저장 및 완료" 클릭
4. 설치 완료!

**이제 컴퓨터를 켤 때마다 자동으로 실행됩니다.**

---

## 📋 필요한 정보

### OpenAI API Key
1. https://platform.openai.com/api-keys 접속
2. "Create new secret key" 클릭
3. 생성된 키 복사

### Notion Integration Token
1. https://www.notion.so/my-integrations 접속
2. "New integration" 클릭
3. 이름 입력 후 생성
4. "Internal Integration Token" 복사

### Notion Database ID
1. Notion에서 가계부 데이터베이스 열기
2. 우측 상단 "..." → "Copy link" 클릭
3. URL에서 ID 부분 복사
   - 예: `https://www.notion.so/1242331a60ad451f8eec2b3e2fd47236`
   - ID: `1242331a60ad451f8eec2b3e2fd47236`

### Notion 데이터베이스 권한 설정
1. 가계부 데이터베이스에서 우측 상단 "..." 클릭
2. "Connections" → 생성한 Integration 선택
3. 권한 부여 완료

---

## 🎯 사용 방법

### 자동 실행 (권장)
- 컴퓨터를 켜면 자동으로 백그라운드에서 실행됩니다
- 별도 조작 불필요

### 수동 실행
- **start.bat** 더블클릭
- 백그라운드에서 실행됨

### 영수증 처리
1. 핸드폰으로 영수증 사진 촬영
2. OneDrive에 자동 동기화
3. 프로그램이 자동으로 감지 및 처리
4. Notion 가계부에 자동 입력

---

## ⚙️ 설정 변경

### 재설정이 필요한 경우
1. **setup_wizard.py** 더블클릭
2. 새로운 정보 입력
3. 저장

### 검증 기능 켜기/끄기
`.env` 파일을 메모장으로 열어서 수정:
```env
ENABLE_VALIDATION=true          # 데이터 검증
ENABLE_DUPLICATE_DETECTION=true # 중복 제거
ENABLE_AUTO_CORRECTION=true     # 자동 수정
```

---

## 🛠️ 파일 설명

| 파일 | 용도 |
|------|------|
| **install.bat** | 최초 설치 및 자동 시작 설정 |
| **start.bat** | 프로그램 수동 실행 |
| **uninstall.bat** | 자동 시작 제거 |
| **setup_wizard.py** | 설정 변경 GUI |
| **main.py** | 메인 프로그램 |
| **.env** | 설정 파일 (자동 생성) |

---

## 🔧 문제 해결

### 프로그램이 실행되지 않음
1. 작업 관리자 열기 (Ctrl + Shift + Esc)
2. "세부 정보" 탭에서 `pythonw.exe` 찾기
3. 있으면 실행 중, 없으면 `start.bat` 실행

### 영수증이 처리되지 않음
1. OneDrive 동기화 확인
2. 폴더 경로 확인 (setup_wizard.py로 재설정)
3. `.env` 파일의 `WATCH_DIR` 경로 확인

### API 오류
1. `setup_wizard.py` 실행
2. "연결 테스트" 버튼 클릭
3. 오류 메시지 확인 후 키 재입력

### 자동 시작 안됨
1. `install.bat` 다시 실행
2. 또는 수동으로 시작 프로그램 폴더에 추가:
   - `Win + R` → `shell:startup`
   - `start.bat` 바로가기 복사

---

## 🎓 다른 사용자에게 공유하기

1. 프로그램 폴더 전체를 복사
2. 새 사용자 컴퓨터에 붙여넣기
3. **install.bat** 실행
4. 설정 창에서 본인의 API 키 입력

**주의**: `.env` 파일은 개인정보이므로 공유하지 마세요!

---

## 📊 로그 확인

프로그램 실행 중 콘솔 창에서 실시간 로그 확인:
```
2026-01-30 20:15:23 - Processing new file: receipt_001.jpg
2026-01-30 20:15:35 - Successfully added 5 / 5 items to Notion.
2026-01-30 20:15:37 - Checking for duplicate entries...
```

---

## 🚫 프로그램 중지

### 임시 중지
1. 작업 관리자 열기
2. `pythonw.exe` 프로세스 찾기
3. "작업 끝내기"

### 자동 시작 제거
- **uninstall.bat** 실행

---

## ✅ 체크리스트

설치 전:
- [ ] Python 3.10 이상 설치됨
- [ ] OpenAI API Key 준비
- [ ] Notion Integration Token 준비
- [ ] Notion Database ID 준비
- [ ] Notion 데이터베이스에 Integration 권한 부여

설치 후:
- [ ] `install.bat` 실행 완료
- [ ] 설정 저장 완료
- [ ] 연결 테스트 성공
- [ ] Notion에 "원본파일" 필드 추가 (텍스트 타입)

---

**모든 설정이 완료되면 영수증을 찍기만 하면 자동으로 처리됩니다!** 🎉
